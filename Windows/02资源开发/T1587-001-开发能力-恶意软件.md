# T1587-001-开发能力-恶意软件

## 描述
在入侵目标组织之前，攻击者可能开发恶意软件及其组件，以支持目标定位和攻击执行。恶意软件包括但不限于有效载荷（Payload）、释放程序（Dropper）、后渗透工具、后门（Backdoor）、加壳程序（Packer）、命令与控制（C2）协议以及受感染的可移动存储设备。这些恶意软件旨在实现持久化控制、防御逃逸（如绕过杀毒软件）、数据窃取、破坏系统或执行其他后渗透操作（如提权T1055、横向移动T1021）。

攻击者开发恶意软件可能涉及：
- **内部开发**：利用自身编程技能，开发定制化恶意软件。
- **外包开发**：通过暗网或其他渠道雇佣第三方开发者，定制恶意软件或组件。
- **开源工具修改**：基于现有恶意软件源码（如Mirai、Cobalt Strike）进行二次开发。
- **C2协议定制**：开发与合法服务（如Twitter、Google Drive）通信的C2协议，以掩盖恶意流量。
- **混淆与加壳**：使用加壳工具（如UPX、Themida）或代码混淆技术，规避检测。

恶意软件开发可能需要额外基础设施支持，如C2服务器（T1583-004）、测试环境或Web服务（T1583-006）。攻击者通过定制化开发，确保恶意软件适配目标环境，提高攻击成功率和隐蔽性。

## 测试案例

攻击者的恶意软件开发在企业组织视野之外，暂无案例。

## 检测日志

恶意软件开发通常发生在目标组织监测范围之外，难以直接监测。以下是可能的间接日志来源：
- **网络流量日志**：
  - 检测与已知C2服务器的异常通信（如高频HTTP、DNS请求）。
- **端点日志**：
  - 记录可疑进程、文件创建或网络连接，可能与测试或分发的恶意软件相关。
- **邮件服务器日志**：
  - 检测分发恶意软件的钓鱼邮件。
- **DNS日志**：
  - 记录解析到C2服务器或恶意域名的异常查询。
- **威胁情报日志**：
  - 关联已知的恶意软件样本、C2地址或开发工具。

## 测试复现

暂无

## 测试留痕

暂无

## 检测规则/思路

由于恶意软件开发多发生在目标组织视野之外，检测需聚焦后续阶段：
- **网络流量监控**：
  - 检测与C2服务器的异常通信。
  - 利用snort规则进行监测。

- **端点监控**：
  - 使用EDR检测可疑进程或文件。

- **DNS监控**：
  - 检测解析到C2或恶意域名的查询。

- **威胁情报**：
  - 关联已知恶意软件样本、C2地址或开发工具。

- **SIEM关联**：
  - 使用SIEM（如Splunk、ELK）整合网络、端点和邮件日志，识别恶意软件活动。

## 建议

- **减少暴露**：
  - 限制员工下载未知软件或访问可疑网站。
  - 定期修补系统和应用程序漏洞，防止恶意软件利用。
- **安全加固**：
  - 部署杀毒软件和EDR，检测恶意软件执行。
  - 配置防火墙，限制与已知C2服务器的通信。
  - 使用应用白名单，阻止未授权程序运行。
- **主动监控**：
  - 使用SIEM分析异常网络或端点活动。
  - 进行威胁狩猎，主动搜索恶意软件痕迹。
- **后续检测**：
  - 监控攻击后续阶段（如命令与控制T1102、提权T1055、数据泄露T1567），通过异常行为发现恶意软件活动。

## 参考推荐

- MITRE ATT&CK: T1587-001  
  <https://attack.mitre.org/techniques/T1587/001/>
