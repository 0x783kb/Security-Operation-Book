# T1608-001-部署能力-部署恶意软件

## 描述

攻击者可能将恶意软件上传到第三方或攻击者控制的基础设施，以在定向攻击期间使用。恶意软件可能包括有效载荷、投放器、后渗透工具、后门、加壳程序、C2协议或受感染的可移动存储设备内容。攻击者可能通过将恶意软件部署到可公开访问的Web服务器、云存储、代码托管平台（如GitHub、Pastebin）或第三方软件商店（如AWS Community AMIs、Docker Hub）来实现攻击目标，例如通过用户执行或入侵工具转移技术分发恶意内容。

攻击者可能在之前购买或租用的基础设施（获取基础设施）、被入侵的基础设施（入侵基础设施）或公共Web服务上部署恶意软件。部署的恶意软件可能伪装成合法软件、应用程序二进制文件、虚拟机镜像或容器镜像，以诱导受害者下载或安装。伪装技术（如使用可信来源的名称或图标）可能增加用户执行这些文件的机会。

## 测试案例

暂无，仅提供辅助理解案例：

1. **上传恶意软件到公共存储库**  
   攻击者将伪装成合法工具的恶意二进制文件上传到GitHub或Pastebin，诱导受害者通过社会工程学下载并执行。

2. **部署恶意容器镜像**  
   攻击者将包含后门的Docker镜像上传到Docker Hub，伪装成常用应用程序的镜像，等待受害者在开发或生产环境中拉取并运行。

## 检测日志

**无法有效监测**  
恶意软件的部署通常发生在攻击者控制或第三方基础设施上，与目标系统无直接交互，因此难以通过日志直接检测。可能相关的日志来源包括：

- **系统日志**：如果恶意软件在目标系统上执行，可能在Windows事件日志（如事件ID 4688、4689）中记录异常进程或行为。
- **网络日志**：从可疑来源下载恶意软件的网络流量（如异常的HTTP或DNS请求）可能提供间接线索。
- **安全软件日志**：EDR或防病毒工具可能记录已知恶意软件的签名或异常行为。

## 测试复现

无具体复现方法。  

## 测试留痕

无明显留痕。  
恶意软件的部署活动通常不会在目标系统上留下直接痕迹。

相关留痕可能出现在后续阶段，包括：

- **恶意软件执行**：恶意软件运行可能触发异常进程、文件操作或注册表更改，记录在系统日志或EDR中。
- **网络活动**：从可疑来源下载恶意软件可能生成异常网络流量，记录在IDS/IPS或网络日志中。
- **文件系统痕迹**：恶意软件可能在系统中创建临时文件或配置文件，记录在文件系统日志中。

## 检测规则/思路

**检测规则**  
无明确的检测规则。

## 建议

### 缓解措施

由于恶意软件的部署发生在企业防御和控制范围之外，难以通过预防性措施直接缓解。以下是一些建议：

1. **增强端点防护**  
   - 部署并更新防病毒软件和EDR工具，检测已知恶意软件的签名和行为。  

2. **应用程序白名单**  
   - 部署应用程序白名单策略，仅允许受信任的应用程序运行，减少恶意软件执行的机会。  

3. **网络安全控制**  
   - 配置防火墙和IDS/IPS，阻止与已知恶意基础设施的通信。  
   - 部署DNS过滤，阻止对可疑域名的访问。  

4. **用户教育**  
   - 培训用户识别可疑文件、链接或下载来源，避免从不可信平台下载软件。  
   
5. **系统加固**  
   - 禁用不必要的服务和端口，减少恶意软件利用的攻击面。  
   - 启用系统防护机制，如地址空间布局随机化（ASLR）和数据执行保护（DEP）。

### 检测

由于此类活动通常在目标组织的可见性之外，检测工作应集中在攻击生命周期的后续阶段，包括但不限于：  
- **用户执行检测**：监控系统中异常的可执行文件或脚本运行，识别潜在的恶意软件执行。  
- **网络行为监控**：通过IDS/IPS或SIEM系统，关注从可疑来源下载文件或与C2服务器通信的流量。  
- **日志分析**：分析系统日志（如Windows事件ID 4688、5156）或安全软件日志，识别与恶意软件部署相关的行为。  
- **威胁情报整合**：利用威胁情报平台，关联已知恶意软件的IOC（Indicators of Compromise），如文件哈希、IP地址或域名。

## 参考推荐

- MITRE ATT&CK: T1608-001  
  <https://attack.mitre.org/techniques/T1608/001/>