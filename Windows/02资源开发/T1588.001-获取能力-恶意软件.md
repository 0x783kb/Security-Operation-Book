# T1588-001-获取能力-恶意软件

## 描述

在入侵目标组织之前，攻击者可能会购买、窃取或下载可在目标定位期间使用的恶意软件和恶意软件组件。恶意软件可能包括有效载荷、释放程序、后渗透工具、后门、加壳程序、C2协议以及创建受感染的可移动存储设备。攻击者可能会获取恶意软件来支持其操作，创建一种手段来维持对远程计算机的控制、防御逃逸及执行后渗透动作。

攻击者除了可以从互联网上下载免费的恶意软件外，还可以从第三方实体购买这些功能。第三方实体可以包括专门从事恶意软件开发的技术公司、网络犯罪市场（包括恶意软件即服务或MaaS）或个人。除了购买恶意软件外，攻击者还可以从第三方实体（包括其他攻击者）窃取恶意软件并用于其它目的。获取的恶意软件可能被定制化以适应特定目标或攻击场景，从而提高攻击的隐蔽性和成功率。

## 测试案例

暂无，仅提供辅助理解案例：

1. **购买恶意软件即服务（MaaS）**  
   攻击者通过暗网市场购买现成的恶意软件（如Emotet或TrickBot），用于分发勒索软件或窃取凭据。这些服务通常提供用户友好的界面，便于非技术人员使用。  

2. **窃取开源恶意软件**  
   攻击者从GitHub或其他公开平台下载开源恶意软件代码（如Remote Access Trojans或RATs），对其进行修改后用于针对性攻击。例如，修改开源RAT以添加自定义C2通信协议。

## 检测日志

**无法有效监测**  
恶意软件的获取通常发生在攻击者的环境中，与目标系统无直接交互，因此难以通过日志直接检测。可能相关的日志来源包括：

- **系统日志**：如果恶意软件在目标系统上执行，可能在Windows事件日志（如事件ID 4688、4689）中记录异常进程或行为。
- **安全软件日志**：EDR或防病毒工具可能记录已知恶意软件的签名或异常行为。
- **网络日志**：与C2通信相关的网络流量（如异常的HTTP或DNS请求）可能提供间接线索。

## 测试复现

无具体复现方法。  

## 测试留痕

无明显留痕。  
恶意软件的获取活动通常不会在目标系统上留下直接痕迹。相关留痕可能出现在后续阶段，包括：

- **恶意软件执行**：恶意软件运行可能触发异常进程、文件操作或注册表更改，记录在系统日志或EDR中。
- **网络活动**：与C2服务器的通信可能生成异常网络流量（如DNS请求或加密通信），记录在IDS/IPS或网络日志中。
- **文件系统痕迹**：恶意软件可能在系统中创建临时文件或配置文件，记录在文件系统日志中。

## 检测规则/思路

**检测规则**  
无明确的检测规则。由于恶意软件的获取主要发生在攻击者的环境中，传统日志分析或入侵检测系统难以直接捕获。以下是一些可能的检测思路：

1. **监控异常进程行为**  
   - 使用EDR工具检测异常进程启动或行为，如未知可执行文件的运行或异常的系统调用。  

2. **网络流量分析**  
   - 监控异常的网络通信，如与已知恶意C2服务器的连接或异常的DNS请求。  

3. **文件系统监控**  
   - 检测系统中出现的未知或可疑文件（如带有随机名称的.exe文件）。  

4. **威胁情报整合**  
   - 使用威胁情报平台（如VirusTotal、AlienVault）检查已知恶意软件的哈希、IP地址或域名，关联潜在的攻击活动。

## 建议

### 缓解措施

由于恶意软件的获取发生在企业防御和控制范围之外，难以通过预防性措施直接缓解。以下是一些建议：

1. **增强端点防护**  
   - 部署并更新防病毒软件和EDR工具，检测已知恶意软件的签名和行为。  

2. **应用程序白名单**  
   - 部署应用程序白名单策略，仅允许受信任的应用程序运行，减少恶意软件执行的机会。  

3. **网络安全控制**  
   - 配置防火墙和IDS/IPS，阻止与已知恶意C2服务器的通信。  
   - 部署DNS过滤，阻止对可疑域名的访问。  

4. **用户教育**  
   - 培训用户识别可疑文件、电子邮件附件或链接，避免触发恶意软件。  
   - 教授用户检查文件来源和数字签名。

5. **系统加固**  
   - 禁用不必要的服务和端口，减少恶意软件利用的攻击面。  
   - 启用系统防护机制，如地址空间布局随机化（ASLR）和数据执行保护（DEP）。

### 检测

由于此类活动通常在目标组织的可见性之外，检测工作应集中在攻击生命周期中的后续行为上，包括但不限于：  
- **异常行为检测**：监控系统中的异常进程、文件操作或注册表更改，识别潜在的恶意软件执行。  
- **网络行为监控**：通过IDS/IPS或SIEM系统，关注异常的网络流量模式，如与可疑IP或域名的通信。  
- **日志分析**：分析系统日志（如Windows事件ID 4688、5156）或安全软件日志，识别与恶意软件相关的行为（如后门或C2通信）。  
- **威胁情报整合**：利用威胁情报平台，关联已知恶意软件的IOC（Indicators of Compromise），如文件哈希、IP地址或域名。

## 参考推荐

- MITRE ATT&CK: T1588-001  
  <https://attack.mitre.org/techniques/T1588/001/>